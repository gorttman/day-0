# FILE: roles/prep-rootfs/tasks/configure_hostname.yml
---
# Set a default hostname; firstboot may override from /state/hostname.

- name: Set /etc/hostname
  ansible.builtin.copy:
    dest: "{{ staging_rootfs }}/etc/hostname"
    mode: "0644"
    content: "{{ default_hostname }}\n"

- name: Ensure /etc/hosts has localhost and hostname entry
  ansible.builtin.copy:
    dest: "{{ staging_rootfs }}/etc/hosts"
    mode: "0644"
    content: |
      127.0.0.1   localhost
      127.0.1.1   {{ default_hostname }}
      
      ::1         localhost ip6-localhost ip6-loopback
      ff02::1     ip6-allnodes
      ff02::2     ip6-allrouters
